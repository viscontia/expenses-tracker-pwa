import{r as l,t as b,j as e}from"./index-DRQOx_Xf.js";import{S as _,L as C,a as Y}from"./lucide-react-Df_vrqSX.js";import{u as ee,U as ae}from"./UnsavedChangesModal-WPjUveF1.js";import{P as oe}from"./user-jjiIB_Y9.js";import{C as te}from"./info-DJPN9HXl.js";import{X as D}from"./x-DeAad_EH.js";import{L as H}from"./loader-circle-CIeghaF9.js";import{T as re}from"./trash-2-SXi9PSPc.js";import"./createLucideIcon-BKpj3lx_.js";import"./dollar-sign-Bgq7nrk_.js";import"./calendar-D2ZVVomX.js";import"./chart-no-axes-column-BEmRDXOw.js";import"./trending-up-BLktqF8c.js";import"./file-text-GkSa6YAt.js";import"./funnel-BOiw8F9t.js";const B={ShoppingCart:{name:"ShoppingCart",keywords:["shopping","cart","trolley","supermarket","grocery","store","buy","purchase","spesa","carrello","supermercato"],category:"shopping"},ShoppingBag:{name:"ShoppingBag",keywords:["shopping","bag","retail","store","purchase","buy","borsa","spesa","negozio"],category:"shopping"},ShoppingBasket:{name:"ShoppingBasket",keywords:["shopping","basket","groceries","supermarket","food","cestino","spesa","alimentari"],category:"shopping"},Store:{name:"Store",keywords:["store","shop","retail","business","negozio","attività","commercio"],category:"shopping"},Truck:{name:"Truck",keywords:["truck","delivery","transport","cargo","trolley","camion","consegna","trasporto","carico"],category:"transport"},Package:{name:"Package",keywords:["package","box","delivery","shipping","pacco","scatola","consegna","spedizione"],category:"shopping"},Luggage:{name:"Luggage",keywords:["luggage","suitcase","travel","trolley","baggage","valigia","viaggio","bagaglio"],category:"transport"},UtensilsCrossed:{name:"UtensilsCrossed",keywords:["food","eat","dining","restaurant","meal","utensils","fork","knife","cibo","mangiare","ristorante","posate"],category:"food"},Coffee:{name:"Coffee",keywords:["coffee","drink","cafe","beverage","caffè","bar","bevanda"],category:"food"},Pizza:{name:"Pizza",keywords:["pizza","food","italian","restaurant","fast food","cibo","italiano","ristorante"],category:"food"},Wine:{name:"Wine",keywords:["wine","alcohol","drink","restaurant","vino","alcol","bevanda","ristorante"],category:"food"},IceCream:{name:"IceCream",keywords:["ice cream","dessert","sweet","gelato","dolce","dessert"],category:"food"},Car:{name:"Car",keywords:["car","vehicle","transport","auto","drive","automotive","macchina","automobile","trasporto","guidare"],category:"transport"},Bus:{name:"Bus",keywords:["bus","public transport","travel","autobus","trasporto pubblico","viaggio"],category:"transport"},Train:{name:"Train",keywords:["train","railway","transport","travel","treno","ferrovia","trasporto","viaggio"],category:"transport"},Plane:{name:"Plane",keywords:["plane","airplane","flight","travel","aereo","volo","viaggio"],category:"transport"},Bike:{name:"Bike",keywords:["bike","bicycle","cycling","transport","bici","bicicletta","ciclismo","trasporto"],category:"transport"},Fuel:{name:"Fuel",keywords:["fuel","gas","petrol","gasoline","benzina","carburante","gas"],category:"transport"},ParkingCircle:{name:"ParkingCircle",keywords:["parking","car","vehicle","parcheggio","auto","veicolo"],category:"transport"},Home:{name:"Home",keywords:["home","house","residence","living","casa","abitazione","dimora"],category:"home"},Bed:{name:"Bed",keywords:["bed","sleep","bedroom","furniture","letto","dormire","camera","arredamento"],category:"home"},Sofa:{name:"Sofa",keywords:["sofa","couch","furniture","living room","divano","arredamento","soggiorno"],category:"home"},Lightbulb:{name:"Lightbulb",keywords:["light","bulb","electricity","illumination","luce","lampadina","elettricità","illuminazione"],category:"home"},Zap:{name:"Zap",keywords:["electricity","power","energy","electric","elettricità","energia","corrente"],category:"home"},Droplets:{name:"Droplets",keywords:["water","droplets","liquid","acqua","gocce","liquido"],category:"home"},Heart:{name:"Heart",keywords:["health","medical","heart","cardio","love","salute","medico","cuore","amore"],category:"health"},Pill:{name:"Pill",keywords:["medicine","pill","pharmacy","health","drug","medicina","pillola","farmacia","salute"],category:"health"},Stethoscope:{name:"Stethoscope",keywords:["medical","doctor","health","stethoscope","medico","dottore","salute","stetoscopio"],category:"health"},Activity:{name:"Activity",keywords:["activity","health","fitness","exercise","attività","salute","fitness","esercizio"],category:"health"},DollarSign:{name:"DollarSign",keywords:["money","dollar","finance","currency","payment","soldi","dollaro","finanza","valuta","pagamento"],category:"finance"},Euro:{name:"Euro",keywords:["money","euro","finance","currency","payment","soldi","finanza","valuta","pagamento"],category:"finance"},PoundSterling:{name:"PoundSterling",keywords:["money","pound","sterling","finance","currency","soldi","sterlina","finanza","valuta"],category:"finance"},CreditCard:{name:"CreditCard",keywords:["card","credit","payment","finance","bank","carta","credito","pagamento","banca"],category:"finance"},Banknote:{name:"Banknote",keywords:["money","cash","banknote","finance","soldi","contanti","banconota","finanza"],category:"finance"},Coins:{name:"Coins",keywords:["money","coins","change","finance","soldi","monete","spiccioli","finanza"],category:"finance"},Wallet:{name:"Wallet",keywords:["wallet","money","finance","cash","portafoglio","soldi","finanza","contanti"],category:"finance"},Receipt:{name:"Receipt",keywords:["receipt","bill","payment","invoice","scontrino","conto","pagamento","fattura"],category:"finance"},Gamepad2:{name:"Gamepad2",keywords:["gaming","games","entertainment","play","gamepad","giochi","intrattenimento","giocare"],category:"entertainment"},Music:{name:"Music",keywords:["music","audio","sound","entertainment","musica","suono","intrattenimento"],category:"entertainment"},Headphones:{name:"Headphones",keywords:["headphones","music","audio","sound","cuffie","musica","suono"],category:"entertainment"},Film:{name:"Film",keywords:["movie","film","cinema","entertainment","video","cinema","intrattenimento"],category:"entertainment"},Camera:{name:"Camera",keywords:["camera","photo","photography","picture","fotografia","foto","immagine"],category:"entertainment"},GraduationCap:{name:"GraduationCap",keywords:["education","graduation","school","university","learning","educazione","laurea","scuola","università"],category:"education"},Book:{name:"Book",keywords:["book","reading","education","literature","libro","lettura","educazione","letteratura"],category:"education"},Briefcase:{name:"Briefcase",keywords:["work","business","office","professional","lavoro","ufficio","professionale","valigetta"],category:"education"},Laptop:{name:"Laptop",keywords:["computer","laptop","technology","work","computing","computer","tecnologia","lavoro"],category:"education"},Palette:{name:"Palette",keywords:["art","painting","colors","creative","palette","arte","pittura","colori","creativo"],category:"lifestyle"},PaintRoller:{name:"PaintRoller",keywords:["paint","painting","home improvement","diy","roller","verniciare","pittura","rullo","casa"],category:"lifestyle"},Scissors:{name:"Scissors",keywords:["scissors","cut","craft","tools","forbici","tagliare","artigianato","strumenti"],category:"lifestyle"},Shirt:{name:"Shirt",keywords:["clothes","clothing","fashion","shirt","wear","vestiti","abbigliamento","moda","camicia"],category:"lifestyle"},Wrench:{name:"Wrench",keywords:["tools","repair","maintenance","fix","strumenti","riparazione","manutenzione","aggiustare"],category:"tools"},Hammer:{name:"Hammer",keywords:["tools","construction","build","hammer","strumenti","costruzione","martello"],category:"tools"},Settings:{name:"Settings",keywords:["settings","configuration","options","preferences","impostazioni","configurazione","opzioni"],category:"tools"},Trees:{name:"Trees",keywords:["nature","trees","environment","green","forest","natura","alberi","ambiente","verde","foresta"],category:"nature"},Flower:{name:"Flower",keywords:["nature","flower","garden","plant","natura","fiore","giardino","pianta"],category:"nature"},Sun:{name:"Sun",keywords:["sun","weather","sunny","light","sole","tempo","soleggiato","luce"],category:"nature"},Hospital:{name:"Hospital",keywords:["hospital","medical","health","emergency","ospedale","medico","salute","emergenza"],category:"services"},School:{name:"School",keywords:["school","education","learning","building","scuola","educazione","apprendimento"],category:"services"},Building:{name:"Building",keywords:["building","office","business","structure","edificio","ufficio","struttura"],category:"services"},Gift:{name:"Gift",keywords:["gift","present","celebration","birthday","regalo","presente","celebrazione","compleanno"],category:"special"},PartyPopper:{name:"PartyPopper",keywords:["party","celebration","fun","festa","celebrazione","divertimento"],category:"special"},Type:{name:"Type",keywords:["text","type","typography","font","testo","carattere","tipografia"],category:"text"},AlignLeft:{name:"AlignLeft",keywords:["align","left","text","alignment","allinea","sinistra","testo"],category:"text"},AlignCenter:{name:"AlignCenter",keywords:["align","center","text","alignment","allinea","centro","testo"],category:"text"},AlignRight:{name:"AlignRight",keywords:["align","right","text","alignment","allinea","destra","testo"],category:"text"},AlignJustify:{name:"AlignJustify",keywords:["align","justify","text","alignment","allinea","giustifica","testo"],category:"text"},Bold:{name:"Bold",keywords:["bold","text","format","grassetto","testo","formato"],category:"text"},Italic:{name:"Italic",keywords:["italic","text","format","corsivo","testo","formato"],category:"text"},Underline:{name:"Underline",keywords:["underline","text","format","sottolineato","testo","formato"],category:"text"},MessageCircle:{name:"MessageCircle",keywords:["message","chat","communication","talk","messaggio","chat","comunicazione"],category:"communication"},MessageSquare:{name:"MessageSquare",keywords:["message","chat","communication","talk","messaggio","chat","comunicazione"],category:"communication"},Phone:{name:"Phone",keywords:["phone","call","telephone","communication","telefono","chiamata","comunicazione"],category:"communication"},PhoneCall:{name:"PhoneCall",keywords:["phone","call","telephone","communication","telefono","chiamata","comunicazione"],category:"communication"},Video:{name:"Video",keywords:["video","camera","recording","multimedia","filmato","registrazione"],category:"communication"},Microphone:{name:"Microphone",keywords:["microphone","audio","sound","record","microfono","audio","suono","registra"],category:"communication"},MicrophoneOff:{name:"MicrophoneOff",keywords:["microphone","mute","audio","sound","off","microfono","muto","spento"],category:"communication"},Smartphone:{name:"Smartphone",keywords:["smartphone","mobile","device","phone","cellulare","dispositivo","telefono"],category:"devices"},Tablet:{name:"Tablet",keywords:["tablet","device","mobile","ipad","dispositivo","mobile"],category:"devices"},Monitor:{name:"Monitor",keywords:["monitor","screen","display","computer","schermo","display","computer"],category:"devices"},Tv:{name:"Tv",keywords:["tv","television","screen","display","televisione","schermo"],category:"devices"},Wifi:{name:"Wifi",keywords:["wifi","wireless","internet","connection","senza fili","connessione"],category:"devices"},WifiOff:{name:"WifiOff",keywords:["wifi","wireless","off","disconnected","senza fili","disconnesso"],category:"devices"},Bluetooth:{name:"Bluetooth",keywords:["bluetooth","wireless","connection","pairing","senza fili","connessione"],category:"devices"},Battery:{name:"Battery",keywords:["battery","power","energy","charge","batteria","energia","carica"],category:"devices"},BatteryLow:{name:"BatteryLow",keywords:["battery","low","power","energy","batteria","scarica","energia"],category:"devices"},Power:{name:"Power",keywords:["power","on","off","electricity","energia","acceso","spento"],category:"devices"},PowerOff:{name:"PowerOff",keywords:["power","off","shutdown","spegnere","energia","spento"],category:"devices"},Play:{name:"Play",keywords:["play","start","begin","multimedia","riproduci","inizia","multimedia"],category:"actions"},Pause:{name:"Pause",keywords:["pause","stop","break","multimedia","pausa","ferma","multimedia"],category:"actions"},Stop:{name:"Stop",keywords:["stop","end","halt","multimedia","ferma","fine","multimedia"],category:"actions"},SkipForward:{name:"SkipForward",keywords:["skip","forward","next","multimedia","salta","avanti","prossimo"],category:"actions"},SkipBack:{name:"SkipBack",keywords:["skip","back","previous","multimedia","salta","indietro","precedente"],category:"actions"},Rewind:{name:"Rewind",keywords:["rewind","back","reverse","multimedia","riavvolgi","indietro"],category:"actions"},FastForward:{name:"FastForward",keywords:["fast","forward","speed","multimedia","veloce","avanti","velocità"],category:"actions"},Volume2:{name:"Volume2",keywords:["volume","sound","audio","loud","volume","suono","audio","alto"],category:"actions"},Volume1:{name:"Volume1",keywords:["volume","sound","audio","medium","volume","suono","audio","medio"],category:"actions"},VolumeX:{name:"VolumeX",keywords:["volume","mute","silent","audio","muto","silenzioso"],category:"actions"},Menu:{name:"Menu",keywords:["menu","navigation","hamburger","list","navigazione","lista"],category:"interface"},MoreHorizontal:{name:"MoreHorizontal",keywords:["more","options","horizontal","dots","altro","opzioni","punti"],category:"interface"},MoreVertical:{name:"MoreVertical",keywords:["more","options","vertical","dots","altro","opzioni","punti"],category:"interface"},Grid:{name:"Grid",keywords:["grid","layout","table","matrix","griglia","tabella","matrice"],category:"interface"},List:{name:"List",keywords:["list","items","menu","navigation","lista","elementi","navigazione"],category:"interface"},Layers:{name:"Layers",keywords:["layers","stack","depth","design","livelli","strati","design"],category:"interface"},Filter:{name:"Filter",keywords:["filter","search","sort","organize","filtro","cerca","ordina"],category:"interface"},Search:{name:"Search",keywords:["search","find","look","magnify","cerca","trova","lente"],category:"interface"},Building2:{name:"Building2",keywords:["building","office","company","business","edificio","ufficio","azienda"],category:"business"},Factory:{name:"Factory",keywords:["factory","industry","manufacturing","production","fabbrica","industria","produzione"],category:"business"},Landmark:{name:"Landmark",keywords:["landmark","building","monument","architecture","monumento","architettura"],category:"business"},BarChart:{name:"BarChart",keywords:["chart","bar","graph","data","analytics","grafico","barre","dati"],category:"charts"},BarChart2:{name:"BarChart2",keywords:["chart","bar","graph","data","analytics","grafico","barre","dati"],category:"charts"},BarChart3:{name:"BarChart3",keywords:["chart","bar","graph","data","analytics","grafico","barre","dati"],category:"charts"},LineChart:{name:"LineChart",keywords:["chart","line","graph","data","trend","grafico","linea","dati","trend"],category:"charts"},PieChart:{name:"PieChart",keywords:["chart","pie","graph","data","percentage","grafico","torta","percentuale"],category:"charts"},TrendingUp:{name:"TrendingUp",keywords:["trending","up","growth","increase","crescita","aumento","su"],category:"charts"},TrendingDown:{name:"TrendingDown",keywords:["trending","down","decline","decrease","calo","diminuzione","giù"],category:"charts"},Clock:{name:"Clock",keywords:["clock","time","hour","schedule","orologio","tempo","ora"],category:"time"},Calendar:{name:"Calendar",keywords:["calendar","date","schedule","time","calendario","data","programma"],category:"time"},CalendarDays:{name:"CalendarDays",keywords:["calendar","days","date","schedule","calendario","giorni","data"],category:"time"},Timer:{name:"Timer",keywords:["timer","countdown","time","clock","timer","conto alla rovescia","tempo"],category:"time"},Stopwatch:{name:"Stopwatch",keywords:["stopwatch","timer","time","measure","cronometro","tempo","misura"],category:"time"},AlarmClock:{name:"AlarmClock",keywords:["alarm","clock","wake","time","sveglia","orologio","tempo"],category:"time"},MapPin:{name:"MapPin",keywords:["map","pin","location","place","marker","mappa","posizione","luogo"],category:"location"},Map:{name:"Map",keywords:["map","navigation","location","geography","mappa","navigazione","geografia"],category:"location"},Navigation:{name:"Navigation",keywords:["navigation","direction","compass","guide","navigazione","direzione","bussola"],category:"location"},Compass:{name:"Compass",keywords:["compass","direction","navigation","north","bussola","direzione","nord"],category:"location"},Globe:{name:"Globe",keywords:["globe","world","earth","planet","internet","globo","mondo","terra"],category:"location"},Cog:{name:"Cog",keywords:["cog","settings","gear","configuration","ingranaggio","impostazioni","configurazione"],category:"system"},Sliders:{name:"Sliders",keywords:["sliders","controls","settings","adjust","cursori","controlli","regola"],category:"system"},SlidersHorizontal:{name:"SlidersHorizontal",keywords:["sliders","controls","settings","horizontal","cursori","controlli","orizzontale"],category:"system"},ToggleLeft:{name:"ToggleLeft",keywords:["toggle","switch","off","disable","interruttore","spento","disabilita"],category:"system"},ToggleRight:{name:"ToggleRight",keywords:["toggle","switch","on","enable","interruttore","acceso","abilita"],category:"system"},Lock:{name:"Lock",keywords:["lock","secure","private","password","blocco","sicuro","privato"],category:"security"},Unlock:{name:"Unlock",keywords:["unlock","open","access","password","sblocca","apri","accesso"],category:"security"},Key:{name:"Key",keywords:["key","password","access","secure","chiave","password","accesso"],category:"security"},Shield:{name:"Shield",keywords:["shield","protection","security","safe","scudo","protezione","sicurezza"],category:"security"},ShieldCheck:{name:"ShieldCheck",keywords:["shield","check","verified","secure","safe","scudo","verificato","sicuro"],category:"security"},Eye:{name:"Eye",keywords:["eye","view","see","visible","watch","occhio","vedi","visibile"],category:"security"},EyeOff:{name:"EyeOff",keywords:["eye","hidden","invisible","hide","private","occhio","nascosto","privato"],category:"security"},Paintbrush:{name:"Paintbrush",keywords:["paintbrush","paint","art","design","brush","pennello","pittura","arte"],category:"design"},Paintbrush2:{name:"Paintbrush2",keywords:["paintbrush","paint","art","design","brush","pennello","pittura","arte"],category:"design"},Pen:{name:"Pen",keywords:["pen","write","edit","draw","penna","scrivi","modifica","disegna"],category:"design"},PenTool:{name:"PenTool",keywords:["pen","tool","draw","design","vector","penna","strumento","disegna"],category:"design"},Pencil:{name:"Pencil",keywords:["pencil","draw","sketch","edit","matita","disegna","schizzo","modifica"],category:"design"},Eraser:{name:"Eraser",keywords:["eraser","delete","remove","clean","gomma","cancella","rimuovi"],category:"design"},Crop:{name:"Crop",keywords:["crop","cut","trim","resize","ritaglia","taglia","ridimensiona"],category:"design"},Move:{name:"Move",keywords:["move","drag","position","relocate","muovi","trascina","posizione"],category:"design"},RotateCw:{name:"RotateCw",keywords:["rotate","clockwise","turn","spin","ruota","orario","gira"],category:"design"},RotateCcw:{name:"RotateCcw",keywords:["rotate","counterclockwise","turn","spin","ruota","antiorario","gira"],category:"design"},FlipHorizontal:{name:"FlipHorizontal",keywords:["flip","horizontal","mirror","reverse","capovolgi","orizzontale","specchia"],category:"design"},FlipVertical:{name:"FlipVertical",keywords:["flip","vertical","mirror","reverse","capovolgi","verticale","specchia"],category:"design"}};function O(r){const o=[],i=r.replace(/([A-Z])/g," $1").trim().toLowerCase().split(" ");o.push(...i),i.forEach(t=>{t.endsWith("s")&&t.length>3?o.push(t.slice(0,-1)):t.endsWith("s")||o.push(t+"s"),t.endsWith("ed")&&o.push(t.slice(0,-2)),t.endsWith("ing")&&o.push(t.slice(0,-3))});const n={home:["casa","dimora"],user:["utente","persona"],file:["file","documento"],folder:["cartella","directory"],edit:["modifica","modifica"],delete:["cancella","elimina"],add:["aggiungi","inserisci"],remove:["rimuovi","togli"],search:["cerca","trova"],save:["salva","conserva"],open:["apri","spalanca"],close:["chiudi","serra"],copy:["copia","duplica"],cut:["taglia","ritaglia"],paste:["incolla","attacca"],send:["invia","manda"],download:["scarica","download"],upload:["carica","upload"],share:["condividi","partecipa"],print:["stampa","stampa"],email:["email","posta"],phone:["telefono","chiamata"],message:["messaggio","comunicazione"],time:["tempo","ora"],date:["data","giorno"],calendar:["calendario","agenda"],clock:["orologio","tempo"],star:["stella","preferito"],heart:["cuore","amore"],like:["mi piace","gradire"],dislike:["non mi piace","non gradire"]};return i.forEach(t=>{n[t]&&o.push(...n[t])}),[...new Set(o)]}function ie(r,o){if(!o.trim())return r;const i=o.toLowerCase().trim();return r.filter(n=>{if(n.toLowerCase().includes(i))return!0;const t=B[n];return t?t.keywords.some(p=>p.toLowerCase().includes(i)):O(n).some(p=>p.toLowerCase().includes(i))})}function ne(r){const o=B[r];return o?o.keywords:O(r)}function se(r){const o=B[r];return o?o.category:ce(r)}function ce(r){const o=r.toLowerCase(),i={communication:["phone","message","chat","mail","call","mic","video"],file:["file","folder","document","pdf","image","download","upload"],navigation:["arrow","chevron","direction","move","next","previous"],action:["play","pause","stop","skip","forward","back","rewind"],interface:["menu","grid","list","filter","search","more","toggle"],time:["clock","calendar","time","date","timer","alarm"],shopping:["cart","shopping","store","shop","basket","bag","trolley"],transport:["car","truck","plane","train","bus","bike","ship"],weather:["sun","cloud","rain","snow","wind","storm"],social:["user","users","person","people","group","share"],system:["settings","cog","gear","option","config","setup"],security:["lock","unlock","key","shield","secure","private"],health:["heart","medical","hospital","pill","health","doctor"],business:["briefcase","building","office","work","company"],finance:["dollar","euro","money","coin","bank","payment","card"],design:["palette","brush","pen","pencil","crop","rotate"],food:["coffee","pizza","utensils","restaurant","food","drink"],home:["home","house","room","bed","door","window"],entertainment:["music","game","tv","radio","volume","speaker"],tools:["tool","hammer","wrench","screwdriver","fix","repair"]};for(const[n,t]of Object.entries(i))if(t.some(c=>o.includes(c)))return n;return"other"}const le=()=>Object.keys(C).filter(r=>{const o=C[r];return typeof o=="object"&&o!==null&&r.charAt(0)===r.charAt(0).toUpperCase()&&r!=="createLucideIcon"&&!r.endsWith("Icon")&&!r.includes("lucide")&&!r.startsWith("Lucide")&&o.displayName!==void 0}).sort(),ze=function(){const[o,i]=l.useState(!1),[n,t]=l.useState(!1),[c,p]=l.useState(null),[k,j]=l.useState(null),[I,m]=l.useState(null),[y,z]=l.useState(""),[S,W]=l.useState([]),[s,f]=l.useState({name:"",description:"",icon:"ShoppingCart"});l.useEffect(()=>{W(le())},[]);const N=b.useUtils(),{data:T,isLoading:R}=b.categories.getAll.useQuery(),g=b.categories.create.useMutation({onSuccess:()=>{N.categories.getAll.invalidate(),i(!1),w()}}),u=b.categories.update.useMutation({onSuccess:()=>{N.categories.getAll.invalidate(),i(!1),w()}}),P=b.categories.delete.useMutation({onSuccess:()=>{N.categories.getAll.invalidate(),j(null),m(null)},onError:a=>{j(null),a.data?.code==="CONFLICT"?m("Non puoi eliminare questa categoria perché è utilizzata in alcune spese. Elimina prima le spese associate."):a.data?.code==="NOT_FOUND"?m("Categoria non trovata."):m("Errore durante l'eliminazione della categoria. Riprova."),setTimeout(()=>m(null),5e3)}}),w=()=>{f({name:"",description:"",icon:"ShoppingCart"}),p(null),z(""),t(!1)};l.useMemo(()=>c?{name:c.name,description:c.description||"",icon:c.icon}:{name:"",description:"",icon:"ShoppingCart"},[c]);const U=l.useMemo(()=>s,[s]),A=async()=>{if(!s.name.trim())throw new Error("Il nome della categoria è obbligatorio");c?await u.mutateAsync({id:c.id,...s}):await g.mutateAsync(s)},{hasUnsavedChanges:v,resetChanges:L}=ee({formData:U,onSave:A,isSaving:g.isPending||u.isPending,disabled:!o||n,message:"Hai modificato i dati della categoria. Vuoi salvarli prima di chiudere?"}),[V,x]=l.useState(!1),G=()=>{v?x(!0):(i(!1),w())},K=async()=>{try{await A(),L(),x(!1),i(!1),w()}catch{}},q=()=>{x(!1),i(!1),w()},$=()=>{x(!1)};l.useEffect(()=>{o&&!n&&setTimeout(()=>L(),100)},[o,n,c,L]),l.useEffect(()=>{const a=d=>{(d.ctrlKey||d.metaKey)&&d.key==="s"&&(d.preventDefault(),v&&o&&!n&&E(d))};return o&&document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[v,o,n]);const E=a=>{a.preventDefault(),c?u.mutate({id:c.id,...s}):g.mutate(s)},Z=a=>{p(a),f({name:a.name,description:a.description||"",icon:a.icon}),i(!0)},X=a=>{if(k===a||P.isPending)return;const d=T?.find(h=>h.id===a)?.name||"questa categoria";confirm(`Sei sicuro di voler eliminare "${d}"?

ATTENZIONE: Non potrai eliminarla se è utilizzata in alcune spese.`)&&(j(a),m(null),P.mutate({id:a}))},F=a=>C[a]||Y,M=l.useMemo(()=>ie(S,y),[S,y]);return R?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Categorie"}),e.jsxs("button",{onClick:()=>i(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(oe,{size:20}),"Nuova Categoria"]})]}),I&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(te,{size:20,className:"text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-red-800 mb-1",children:"Impossibile eliminare la categoria"}),e.jsx("p",{className:"text-sm text-red-700",children:I})]}),e.jsx("button",{onClick:()=>m(null),className:"text-red-400 hover:text-red-600 flex-shrink-0",children:e.jsx(D,{size:16})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:T?.map(a=>{const d=F(a.icon);return e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gray-50",children:e.jsx(d,{size:24,className:"text-gray-700"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a.name}),a.description&&e.jsx("p",{className:"text-sm text-gray-600",children:a.description})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Z(a),className:"text-blue-600 hover:text-blue-800 p-1",children:e.jsx(_,{size:16})}),e.jsx("button",{onClick:()=>X(a.id),disabled:k===a.id||P.isPending,className:"text-red-600 hover:text-red-800 p-1 disabled:opacity-50 disabled:cursor-not-allowed",title:k===a.id?"Eliminazione in corso...":"Elimina categoria",children:k===a.id?e.jsx(H,{size:16,className:"animate-spin"}):e.jsx(re,{size:16})})]})]})},a.id)})}),o&&!n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md relative",children:[v&&e.jsx("div",{className:"absolute top-4 right-4 z-10",children:e.jsxs("div",{className:"flex items-center space-x-2 bg-amber-100 dark:bg-amber-900/20 text-amber-800 dark:text-amber-200 px-3 py-1 rounded-full text-xs font-medium border border-amber-200 dark:border-amber-800 shadow-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-amber-500 rounded-full animate-pulse"}),e.jsx("span",{children:"Modifiche non salvate"})]})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:c?"Modifica Categoria":"Nuova Categoria"}),e.jsx("div",{className:"mb-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("div",{className:"flex-shrink-0 w-2 h-2 bg-blue-500 rounded-full mt-2"}),e.jsxs("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:[e.jsx("p",{className:"font-medium mb-1",children:"🛡️ Protezione dati attiva"}),e.jsx("p",{children:"Le tue modifiche sono protette automaticamente. Se tenti di chiudere con modifiche non salvate, ti verrà chiesto di confermare."}),e.jsxs("p",{className:"mt-1",children:[e.jsx("strong",{children:"Tip:"})," Usa ",e.jsx("kbd",{className:"px-1 py-0.5 bg-blue-200 dark:bg-blue-800 rounded",children:"Ctrl+S"})," per salvare rapidamente"]})]})]})}),e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome"}),e.jsx("input",{type:"text",value:s.name,onChange:a=>f({...s,name:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-black placeholder-gray-400",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descrizione"}),e.jsx("input",{type:"text",value:s.description,onChange:a=>f({...s,description:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-black placeholder-gray-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Icona"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 border border-gray-300 rounded-md bg-gray-50",children:(()=>{const a=F(s.icon);return e.jsx(a,{size:24,className:"text-gray-700"})})()}),e.jsx("button",{type:"button",onClick:()=>t(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Scegli Icona"}),e.jsx("span",{className:"text-sm text-gray-600",children:s.icon})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsxs("button",{type:"submit",disabled:g.isPending||u.isPending,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[(g.isPending||u.isPending)&&e.jsx(H,{size:16,className:"animate-spin"}),g.isPending||u.isPending?"Salvando...":c?"Aggiorna":"Crea"]}),e.jsx("button",{type:"button",onClick:G,className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-400",children:"Annulla"})]})]})]})}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-[70]",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Scegli un'Icona"}),e.jsx("button",{onClick:()=>t(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx(D,{size:24})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("input",{type:"text",placeholder:"Cerca icona (es: trolley, shopping, food, casa, macchina)...",value:y,onChange:a=>z(a.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-black placeholder-gray-400"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["💡 ",e.jsx("strong",{children:"Suggerimento:"}),' Puoi cercare per nome tecnico (es: "ShoppingCart") o per keywords semantiche (es: "trolley", "carrello", "spesa")']})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsx("div",{className:"grid grid-cols-6 gap-4",children:M.map(a=>{const d=C[a],h=ne(a),J=se(a),Q=h.length>0?`${a}
Keywords: ${h.slice(0,5).join(", ")}${h.length>5?"...":""}
Categoria: ${J}`:a;return e.jsxs("button",{type:"button",onClick:()=>{f({...s,icon:a}),t(!1),z("")},className:`p-3 border rounded-lg hover:bg-gray-100 flex flex-col items-center justify-center transition-colors min-h-[110px] w-full ${s.icon===a?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,title:Q,children:[e.jsx(d,{size:28,className:`mb-2 ${s.icon===a?"text-blue-600":"text-gray-700 hover:text-gray-900"}`}),e.jsxs("span",{className:"text-xs text-center break-words text-gray-700 font-medium leading-tight px-1 overflow-hidden max-h-8 relative",children:[a,h.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-green-500 rounded-full",title:"Ha keywords di ricerca"})]})]},a)})}),M.length===0&&y&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:['Nessuna icona trovata per "',y,'"']})]}),e.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[M.length," icone trovate su ",S.length," totali",y&&e.jsx("span",{className:"ml-2 text-blue-600",children:"• Ricerca semantica attiva 🔍"})]}),e.jsx("button",{onClick:()=>t(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Chiudi"})]})]})}),e.jsx(ae,{isOpen:V,onSaveAndExit:K,onExitWithoutSaving:q,onCancel:$,isSaving:g.isPending||u.isPending,message:"Hai modificato i dati della categoria. Vuoi salvarli prima di chiudere?"})]})};export{ze as component};
