import{c as y}from"./createLucideIcon-BKpj3lx_.js";import{r,j as e,q as C}from"./index-DRQOx_Xf.js";import{X as k}from"./x-DeAad_EH.js";/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],M=y("save",E);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],q=y("tag",S);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],A=y("triangle-alert",z);function L({isOpen:a,onClose:s,title:c,children:t,size:n="lg"}){if(r.useEffect(()=>{const i=d=>{d.key==="Escape"&&s()};return a&&(document.addEventListener("keydown",i),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",i),document.body.style.overflow="unset"}},[a,s]),!a)return null;const o={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-7xl"};return e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:s}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs("div",{className:`relative w-full ${o[n]} transform overflow-hidden rounded-lg bg-white dark:bg-gray-800 shadow-xl transition-all`,onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:c}),e.jsx("button",{onClick:s,className:"rounded-lg p-2 text-gray-400 hover:bg-gray-100 hover:text-gray-600 dark:hover:bg-gray-700 dark:hover:text-gray-300","aria-label":"Chiudi modale",children:e.jsx(k,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"max-h-[80vh] overflow-y-auto",children:t})]})})]})}function T({formData:a,onSave:s,isSaving:c=!1,disabled:t=!1,message:n="Hai delle modifiche non salvate. Vuoi procedere?"}){C();const o=r.useRef(""),[i,d]=r.useState(!1),[u,b]=r.useState(null),p=r.useRef(!1),f=r.useCallback(l=>{try{return JSON.stringify(l,Object.keys(l).sort())}catch{return""}},[]);r.useEffect(()=>{t||(o.current=f(a))},[t,f,a]);const x=!t&&o.current!==""&&o.current!==f(a)&&!c,h=r.useCallback(()=>{o.current=f(a)},[a,f]);r.useEffect(()=>{if(t)return;const l=m=>{if(x)return m.preventDefault(),m.returnValue=n,n};return window.addEventListener("beforeunload",l),()=>window.removeEventListener("beforeunload",l)},[x,t,n]),r.useEffect(()=>{if(t)return;const l=m=>{const v=m.target.closest("a[href]");v&&v.href&&x&&!p.current&&(m.preventDefault(),d(!0),b(()=>()=>{p.current=!0,window.location.href=v.href}))};return document.addEventListener("click",l,!0),()=>{document.removeEventListener("click",l,!0)}},[x,t]);const g=r.useCallback(()=>{d(!1),u&&(u(),b(null))},[u]),w=r.useCallback(()=>{d(!1),b(null)},[]),j=r.useCallback(async()=>{if(!s){g();return}try{await s(),h(),g()}catch(l){console.error("Errore durante il salvataggio:",l)}},[s,g,h]),N=r.useCallback(()=>{d(!1),b(null)},[]);return{hasUnsavedChanges:x,isModalOpen:i,confirmNavigation:g,cancelNavigation:w,saveAndNavigate:j,resetChanges:h,closeModal:N}}function U({isOpen:a,onSaveAndExit:s,onExitWithoutSaving:c,onCancel:t,isSaving:n=!1,message:o="Hai delle modifiche non salvate. Vuoi procedere?",showSaveButton:i=!0}){const d=async()=>{try{await s()}catch(u){console.error("Errore durante il salvataggio:",u)}};return e.jsx(L,{isOpen:a,onClose:t,title:"Modifiche non salvate",size:"md",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(A,{className:"h-6 w-6 text-amber-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Attenzione!"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:o})]})]}),e.jsxs("div",{className:"mt-6 flex flex-col-reverse sm:flex-row sm:justify-end space-y-2 space-y-reverse sm:space-y-0 sm:space-x-3",children:[e.jsxs("button",{type:"button",onClick:t,disabled:n,className:"inline-flex w-full sm:w-auto justify-center items-center px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Annulla"]}),e.jsx("button",{type:"button",onClick:c,disabled:n,className:"inline-flex w-full sm:w-auto justify-center items-center px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Esci senza Salvare"}),i&&e.jsx("button",{type:"button",onClick:d,disabled:n,className:"inline-flex w-full sm:w-auto justify-center items-center px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Salva ed Esci"]})})]}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:e.jsxs("p",{className:"text-xs text-blue-600 dark:text-blue-400",children:["ðŸ’¡ ",e.jsx("strong",{children:"Suggerimento:"})," Usa ",e.jsx("kbd",{className:"px-1 py-0.5 text-xs font-semibold text-blue-700 dark:text-blue-300 bg-blue-200 dark:bg-blue-800 border border-blue-300 dark:border-blue-600 rounded",children:"Ctrl+S"})," (o ",e.jsx("kbd",{className:"px-1 py-0.5 text-xs font-semibold text-blue-700 dark:text-blue-300 bg-blue-200 dark:bg-blue-800 border border-blue-300 dark:border-blue-600 rounded",children:"Cmd+S"})," su Mac) per salvare rapidamente"]})})]})})}function $({isOpen:a,onExitWithoutSaving:s,onCancel:c,message:t="Hai delle modifiche non salvate. Vuoi procedere comunque?"}){return e.jsx(U,{isOpen:a,onSaveAndExit:()=>{},onExitWithoutSaving:s,onCancel:c,message:t,showSaveButton:!1})}export{L as M,M as S,q as T,U,$ as a,A as b,T as u};
