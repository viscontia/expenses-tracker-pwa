import{j as e,b as j,a as k,t as c,V as m,o as v,r as N,L as u,s as x}from"./index-DRQOx_Xf.js";import{u as w,a as S}from"./zod-CqYVsTtV.js";const C=v({email:x().email("Indirizzo email non valido"),password:x().min(1,"La password è obbligatoria")});function E(){const g=j(),{login:b,rememberMe:t,setRememberMe:p,savedEmail:a}=k(),h=c.useContext(),o=c.auth.login.useMutation({onError:s=>{console.error("tRPC onError callback:",s);let n="Si è verificato un errore durante l'accesso.";s?.message?.includes("Invalid email or password")?n="Email o password errati.":s?.message?.includes("User not found")&&(n="Utente non trovato. Verifica l'email o registrati."),m.error(n,{duration:5e3,position:"top-right"})},onSuccess:s=>{console.log("tRPC onSuccess callback:",s),b({...s.user,preferences:s.user.preferences},s.token),h.auth.getCurrentUser.invalidate(),g({to:"/dashboard"}),m.success("Accesso effettuato con successo!")}}),{register:i,handleSubmit:f,formState:{errors:r,isSubmitting:l},setValue:d}=w({resolver:S(C)});N.useEffect(()=>{t&&a&&d("email",a)},[t,a,d]);const y=s=>{o.mutate(s)};return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900 dark:text-white",children:"Accedi al tuo account"}),e.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600 dark:text-gray-400",children:["Oppure"," ",e.jsx(u,{to:"/register",className:"font-medium text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300",children:"crea un nuovo account"})]})]}),e.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 py-8 px-4 shadow sm:rounded-lg sm:px-10",children:e.jsxs("form",{className:"space-y-6",onSubmit:f(y),children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Indirizzo email"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"email",type:"email",autoComplete:"email",required:!0,...i("email"),className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600"})}),r.email&&e.jsx("p",{className:"mt-2 text-sm text-red-600 dark:text-red-400",children:r.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"password",type:"password",autoComplete:"current-password",required:!0,...i("password"),className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600"})}),r.password&&e.jsx("p",{className:"mt-2 text-sm text-red-600 dark:text-red-400",children:r.password.message})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",checked:t,onChange:s=>p(s.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-900 dark:text-gray-300",children:"Ricordami"})]})}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:l||o.isPending,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:l||o.isPending?"Accesso in corso...":"Accedi"})}),e.jsx("div",{className:"mt-6 p-4 bg-green-50 dark:bg-green-900/20 rounded-md",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("h3",{className:"font-medium text-green-800 dark:text-green-200 mb-2",children:"Nuovo utente?"}),e.jsx("p",{className:"text-green-700 dark:text-green-300 mb-2",children:"Se non hai ancora un account, puoi crearne uno rapidamente."}),e.jsx(u,{to:"/register",className:"font-medium text-green-600 hover:text-green-500 dark:text-green-400 dark:hover:text-green-300",children:"Registrati qui →"})]})})]})})})]})}const A=()=>e.jsx(E,{});export{A as component};
